				PLSQL  ASSIGNMENT 2

  Write a query in SQL to display the first name, last name, department number, and department name for each employee.

Solution :

SELECT 
    e.FIRST_NAME,
    e.LAST_NAME,
    e.DEPARTMENT_ID,
    d.DEPARTMENT_NAME
FROM 
    HR.EMPLOYEES e
JOIN 
    HR.DEPARTMENTS d
ON 
e.DEPARTMENT_ID = d.DEPARTMENT_ID;


Output :
















 Write a query in SQL to display the first and last name, department, city, and state province for each employee.


Solution :


SELECT
    e.FIRST_NAME,
    e.LAST_NAME,
    d.DEPARTMENT_NAME,
    l.CITY,
    l.STATE_PROVINCE
FROM
    HR.EMPLOYEES e
JOIN
    HR.DEPARTMENTS d
ON
    e.DEPARTMENT_ID = d.DEPARTMENT_ID
JOIN
    HR.LOCATIONS l
ON
    d.LOCATION_ID = l.LOCATION_ID;



Output :






  Write a query to display the first name, last name, salary, and job title for all employees.


Solution:


SELECT
    e.FIRST_NAME,
    e.LAST_NAME,
    e.SALARY,
    j.JOB_TITLE
FROM
    HR.EMPLOYEES e
JOIN
    HR.JOBS j
ON
    e.JOB_ID = j.JOB_ID;





















Output :

























 Write a query to display the first name, last name, department number and department name, for all employees for departments 80 or 40.


Solution :

SELECT
    e.FIRST_NAME,
    e.LAST_NAME,
    e.DEPARTMENT_ID,
    d.DEPARTMENT_NAME
FROM
    HR.EMPLOYEES e
JOIN
    HR.DEPARTMENTS d
ON
    e.DEPARTMENT_ID = d.DEPARTMENT_ID
WHERE
    e.DEPARTMENT_ID IN (40, 80);



Output :
















 Write a query to display those employees who contain a letter z to their first name and also display their last name, department, city, and state province.

Solution :

SELECT
    e.FIRST_NAME,
    e.LAST_NAME,
    d.DEPARTMENT_NAME,
    l.CITY,
    l.STATE_PROVINCE
FROM
    HR.EMPLOYEES e
JOIN
    HR.DEPARTMENTS d
ON
    e.DEPARTMENT_ID = d.DEPARTMENT_ID
JOIN
    HR.LOCATIONS l
ON
    d.LOCATION_ID = l.LOCATION_ID
WHERE
    UPPER(e.FIRST_NAME) LIKE '%Z%';


Output :






6.  Write a query to display all departments including those where does not have any employee.

	Solution:
	

	SELECT
    d.DEPARTMENT_ID,
    d.DEPARTMENT_NAME,
    e.FIRST_NAME,
    e.LAST_NAME
FROM
    HR.DEPARTMENTS d
LEFT JOIN
    HR.EMPLOYEES e
ON
    d.DEPARTMENT_ID = e.DEPARTMENT_ID;




Output :















7.   Write a query to display the first and last name and salary for those employees who earn less than the employee earn whose number is 182.




Solution:

SELECT
    FIRST_NAME,
    LAST_NAME,
    SALARY
FROM
    HR.EMPLOYEES
WHERE
SALARY < (SELECT SALARY FROM HR.EMPLOYEES WHERE EMPLOYEE_ID = 182);










Output :







  Write a query to display the first name of all employees including the first name of their manager.


Solution :


SELECT
    e.FIRST_NAME AS "Employee_First_Name",
    m.FIRST_NAME AS "Manager_First_Name"
FROM
    HR.EMPLOYEES e
LEFT JOIN
    HR.EMPLOYEES m
ON
e.MANAGER_ID = m.EMPLOYEE_ID;


Output :















  Write a query to display the department name, city, and state province for each department.

Solution :


SELECT
    d.DEPARTMENT_NAME,
    l.CITY,
    l.STATE_PROVINCE
FROM
    HR.DEPARTMENTS d
JOIN
    HR.LOCATIONS l
ON
    d.LOCATION_ID = l.LOCATION_ID;







Output :











 Write a query to display the first name, last name, department number and name, for all employees who have or have not any department.

Solution :

SELECT
    e.FIRST_NAME,
    e.LAST_NAME,
    e.DEPARTMENT_ID,
    d.DEPARTMENT_NAME
FROM
    HR.EMPLOYEES e
LEFT JOIN
    HR.DEPARTMENTS d
ON
    e.DEPARTMENT_ID = d.DEPARTMENT_ID;



Output :











 Write a query to display the first name of all employees and the first name of their manager including those who does not working under any manager.

Solution :

SELECT
    e1.FIRST_NAME AS "Employee_First_Name",
    e2.FIRST_NAME AS "Manager_First_Name"
FROM
    HR.EMPLOYEES e1
LEFT JOIN
    HR.EMPLOYEES e2
ON
    e1.MANAGER_ID = e2.EMPLOYEE_ID
ORDER BY
    e1.EMPLOYEE_ID;


Output :















 Write a query to display the first name, last name, and department number for those employees who works in the same department as the employee who holds the last name as Taylor.


Solution :


 SELECT
    e.FIRST_NAME,
    e.LAST_NAME,
    e.DEPARTMENT_ID
FROM
    HR.EMPLOYEES e
WHERE
    e.DEPARTMENT_ID IN (
        SELECT
            DEPARTMENT_ID
        FROM
            HR.EMPLOYEES
        WHERE
            LAST_NAME = 'Taylor'
    );

Output :




 



 Write a query to display the job title, department name, full name (first and last name) of employee, and starting date for all the jobs which started on or after 1st January 1993 and ending with on or before 31 August 1997.

Solution :

select j.job_title, d.department_name, e.first_name || ' ' || e.last_name as "Full_NAME"
from hr.employees e
inner join hr.job_history jh on jh.employee_id = e.employee_id
inner join hr.jobs j on jh.job_id = j.job_id
inner join hr.departments d on e.department_id = d.department_id
where jh.start_date >= TO_DATE('1993-01-01', 'YYYY-MM-DD') or jh.end_date <= TO_DATE('1997-08-31', 'YYYY-MM-DD');



Output :














       14.  Write a query to display job title, full name (first and last name) of employee, and the difference between    	maximum salary for the job and salary of the employee.

Solution :


SELECT
    J.JOB_TITLE,
    E.FIRST_NAME || ' ' || E.LAST_NAME AS "Full_Name",
    (J.MAX_SALARY - E.SALARY) AS "Salary_Difference"
FROM
    HR.JOBS J
JOIN
    HR.EMPLOYEES E
ON
    J.JOB_ID = E.JOB_ID;


Output :









15   Write a query to display the name of the department, average salary and number of employees working in that department who got commission.

Solution :

SELECT
    D.DEPARTMENT_NAME,
    AVG(E.SALARY) AS "Average_Salary",
    COUNT(E.EMPLOYEE_ID) AS "Number_of_Employees_with_Commission"
FROM
    HR.DEPARTMENTS D
JOIN
    HR.EMPLOYEES E
ON
    D.DEPARTMENT_ID = E.DEPARTMENT_ID
WHERE
    E.COMMISSION_PCT IS NOT NULL
GROUP BY
    D.DEPARTMENT_NAME;



Output :
  

16   Write a query to display the full name (first and last name) of employees, job title and the salary differences to their own job for those employees who is working in the department ID 80.


Solution :

SELECT
    E.FIRST_NAME || ' ' || E.LAST_NAME AS "Full_Name",
    J.JOB_TITLE,
    E.SALARY - AVG(E.SALARY) OVER (PARTITION BY E.JOB_ID) AS "Salary_Difference"
FROM
    HR.EMPLOYEES E
JOIN
    HR.JOBS J
ON
    E.JOB_ID = J.JOB_ID
WHERE
    E.DEPARTMENT_ID = 80;






Output :




















17    Write a query to display the name of the country, city, and the departments which are running there.

Solution :

SELECT
    C.COUNTRY_NAME AS "Country",
    L.CITY AS "City",
    D.DEPARTMENT_NAME AS "Department"
FROM
    HR.COUNTRIES C
JOIN
    HR.LOCATIONS L
ON
    C.COUNTRY_ID = L.COUNTRY_ID
JOIN
    HR.DEPARTMENTS D
ON
    L.LOCATION_ID = D.LOCATION_ID
ORDER BY
    C.COUNTRY_NAME, L.CITY, D.DEPARTMENT_NAME;



Output :
















18. Write a query to display department name and the full name (first and last name) of the manager.

	Solution :


SELECT
D.DEPARTMENT_NAME,
M.FIRST_NAME || ' ' || M.LAST_NAME AS "Manager_Full_Name"
FROM
HR.DEPARTMENTS D
LEFT JOIN
HR.EMPLOYEES M
ON
D.MANAGER_ID = M.EMPLOYEE_ID;

	Output :

	




Write a query to display job title and average salary of employees

Solution :

SELECT
J.JOB_TITLE,
AVG(E.SALARY) AS "Average_Salary"
FROM
HR.JOBS J
JOIN
HR.EMPLOYEES E
ON
    J.JOB_ID = E.JOB_ID
GROUP BY
J.JOB_TITLE;

Output :







Write a query to display the details of jobs which was done by any of the employees who is presently earning a salary on and above 12000.

Solution :

SELECT DISTINCT
    J.JOB_ID,
    J.JOB_TITLE
FROM
    HR.JOBS J
WHERE
    J.JOB_ID IN (
        SELECT DISTINCT
            E.JOB_ID
        FROM
            HR.EMPLOYEES E
        WHERE
            E.SALARY >= 12000
    );



Output :




21  Write a query to display the country name, city, and number of those departments where at least 2 employees are working.

Solution :

SELECT
    C.COUNTRY_NAME AS "Country",
    L.CITY AS "City",
    COUNT(D.DEPARTMENT_ID) AS "Number_of_Departments"
FROM
    HR.COUNTRIES C
JOIN
    HR.LOCATIONS L
ON
    C.COUNTRY_ID = L.COUNTRY_ID
JOIN
    HR.DEPARTMENTS D
ON
    L.LOCATION_ID = D.LOCATION_ID
JOIN
    HR.EMPLOYEES E
ON
    D.DEPARTMENT_ID = E.DEPARTMENT_ID
GROUP BY
    C.COUNTRY_NAME, L.CITY
HAVING
    COUNT(D.DEPARTMENT_ID) >= 2;


Output :






22  Write a query to display the department name, full name (first and last name) of manager, and their city.

Solution :


SELECT
    D.DEPARTMENT_NAME AS "Department_Name",
    M.FIRST_NAME || ' ' || M.LAST_NAME AS "Manager_Full_Name",
    L.CITY AS "Manager_City"
FROM
    HR.DEPARTMENTS D
JOIN
    HR.EMPLOYEES M
ON
    D.MANAGER_ID = M.EMPLOYEE_ID
JOIN
    HR.LOCATIONS L
ON
    D.LOCATION_ID = L.LOCATION_ID;



Output :










23   Write a query to display the employee ID, job name, number of days worked in for all those jobs in department 80.

Solution :

SELECT
    E.EMPLOYEE_ID,
    J.JOB_TITLE AS "Job_Name",
    TRUNC(SYSDATE - E.HIRE_DATE) AS "Days_Worked"
FROM
    HR.EMPLOYEES E
JOIN
    HR.JOBS J
ON
    E.JOB_ID = J.JOB_ID
WHERE
    E.DEPARTMENT_ID = 80;


Output :










24   Write a query to display the full name (first and last name), and salary of those employees who working in any department located in London.

Solution :

SELECT
    E.FIRST_NAME || ' ' || E.LAST_NAME AS "Full_Name",
    E.SALARY
FROM
    HR.EMPLOYEES E
JOIN
    HR.DEPARTMENTS D
ON
    E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN
    HR.LOCATIONS L
ON
    D.LOCATION_ID = L.LOCATION_ID
WHERE
    L.CITY = 'London';





Output :








25   Write a query to display full name (first and last name), job title, starting and ending date of last jobs for those employees with worked without a commission percentage.

Solution :

SELECT
    E.FIRST_NAME || ' ' || E.LAST_NAME AS "Full_Name",
    J.JOB_TITLE AS "Job_Title",
    JH.START_DATE AS "Starting_Date",
    JH.END_DATE AS "Ending_Date"
FROM
    HR.EMPLOYEES E
JOIN
    HR.JOB_HISTORY JH
ON
    E.EMPLOYEE_ID = JH.EMPLOYEE_ID
JOIN
    HR.JOBS J
ON
    JH.JOB_ID = J.JOB_ID
LEFT JOIN
    HR.DEPARTMENTS D
ON
    E.DEPARTMENT_ID = D.DEPARTMENT_ID
WHERE
    E.COMMISSION_PCT IS NULL
    AND (JH.START_DATE, JH.END_DATE) = (
        SELECT
            MAX(START_DATE), MAX(END_DATE)
        FROM
            HR.JOB_HISTORY
        WHERE
            EMPLOYEE_ID = E.EMPLOYEE_ID
    );







Output :





26   Write a query to display the department name and number of employees in each of the department.

Solution :

SELECT
    D.DEPARTMENT_NAME AS "Department_Name",
    COUNT(E.EMPLOYEE_ID) AS "Number_of_Employees"
FROM
    HR.DEPARTMENTS D
LEFT JOIN
    HR.EMPLOYEES E
ON
    D.DEPARTMENT_ID = E.DEPARTMENT_ID
GROUP BY
    D.DEPARTMENT_NAME
ORDER BY
    "Number_of_Employees" DESC, "Department_Name";



Output :










27   Write a query to display the full name (first and last name) of employee with ID and name of the country presently where (s)he is working.

Solution :

SELECT
    E.EMPLOYEE_ID,
    E.FIRST_NAME || ' ' || E.LAST_NAME AS "Full_Name",
    C.COUNTRY_NAME AS "Country_Name"
FROM
    HR.EMPLOYEES E
JOIN
    HR.DEPARTMENTS D
ON
    E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN
    HR.LOCATIONS L
ON
    D.LOCATION_ID = L.LOCATION_ID
JOIN
    HR.COUNTRIES C
ON
    L.COUNTRY_ID = C.COUNTRY_ID;



Output :









